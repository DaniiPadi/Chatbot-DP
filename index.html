<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diana Padilla Est√©tica y Spa</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #ff6b9d;
            --secondary: #c44569;
            --accent: #f8b500;
            --dark: #1a1a2e;
            --darker: #16213e;
            --light: #eee;
            --white: #ffffff;
            --gradient: linear-gradient(135deg, #ff6b9d, #c44569, #f8b500);
            --shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            color: var(--white);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 107, 157, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(196, 69, 105, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(248, 181, 0, 0.05) 0%, transparent 50%);
            z-index: -1;
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(2deg); }
            66% { transform: translateY(10px) rotate(-1deg); }
        }

        /* Header */
        .header {
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            padding: 1.5rem 0;
            text-align: center;
            border-bottom: 1px solid rgba(255, 107, 157, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            font-weight: 300;
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 120px);
        }

        .chat-messages {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            scroll-behavior: smooth;
        }

        .message {
            display: flex;
            gap: 1rem;
            max-width: 80%;
            animation: slideIn 0.3s ease;
        }

        .user-message {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .bot-message {
            align-self: flex-start;
        }

        .message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
            box-shadow: var(--shadow);
        }

        .bot-message .message-avatar {
            background: var(--gradient);
            color: white;
        }

        .user-message .message-avatar {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            backdrop-filter: blur(10px);
        }

        .message-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            padding: 1rem 1.5rem;
            border-radius: 20px;
            border: 1px solid rgba(255, 107, 157, 0.2);
            font-size: 0.95rem;
            line-height: 1.6;
            box-shadow: var(--shadow);
        }

        .user-message .message-content {
            background: var(--gradient);
            color: white;
            border: none;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 0.5rem;
        }

        /* Interactive Buttons */
        .interactive-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-top: 1rem;
        }

        .option-btn {
            background: rgba(255, 107, 157, 0.2);
            border: 1px solid var(--primary);
            border-radius: 20px;
            padding: 0.6rem 1.2rem;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            backdrop-filter: blur(10px);
        }

        .option-btn:hover {
            background: var(--gradient);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }

        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366, #128C7E);
            border: none;
            border-radius: 25px;
            padding: 0.8rem 1.5rem;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            margin: 0.5rem 0;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .whatsapp-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
        }

        /* Input Area */
        .chat-input {
            padding: 2rem;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 107, 157, 0.2);
        }

        .input-container {
            display: flex;
            gap: 1rem;
            max-width: 900px;
            margin: 0 auto;
        }

        .message-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 107, 157, 0.3);
            border-radius: 25px;
            padding: 1rem 1.5rem;
            color: var(--white);
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .message-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.3);
        }

        .message-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .send-button {
            background: var(--gradient);
            border: none;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }

        .send-button:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(255, 107, 157, 0.4);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 1rem;
            max-width: 80%;
            animation: slideIn 0.3s ease;
        }

        .typing-dots {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            padding: 1rem 1.5rem;
            border-radius: 20px;
            border: 1px solid rgba(255, 107, 157, 0.2);
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        .typing-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-bottom: 1rem;
            justify-content: center;
        }

        .quick-action {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 107, 157, 0.3);
            border-radius: 20px;
            padding: 0.6rem 1.2rem;
            color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        .quick-action:hover {
            background: var(--gradient);
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            margin: 1rem;
            border: 1px solid rgba(255, 107, 157, 0.2);
            backdrop-filter: blur(20px);
        }

        .welcome-message h2 {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .welcome-message p {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1.5rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1rem 0;
            }

            .header h1 {
                font-size: 1.3rem;
                line-height: 1.3;
            }

            .header p {
                font-size: 0.85rem;
                padding: 0 1rem;
            }

            .chat-container {
                height: calc(100vh - 100px);
            }

            .chat-messages {
                padding: 1rem;
                gap: 1rem;
            }

            .chat-input {
                padding: 1rem;
            }

            .message {
                max-width: 95%;
            }

            .message-avatar {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .message-content {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
                border-radius: 15px;
            }

            .quick-actions {
                flex-direction: column;
                gap: 0.5rem;
            }

            .quick-action {
                text-align: center;
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
            }

            .welcome-message {
                padding: 1.5rem;
                margin: 0.5rem;
            }

            .welcome-message h2 {
                font-size: 1.2rem;
            }

            .welcome-message p {
                font-size: 0.9rem;
            }

            /* Responsive Interactive Options */
            .interactive-options {
                flex-direction: column;
                gap: 0.5rem;
                margin-top: 1rem;
            }

            .option-btn {
                text-align: center;
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
                border-radius: 15px;
                width: 100%;
            }

            .whatsapp-btn {
                padding: 0.8rem 1.2rem;
                font-size: 0.85rem;
                border-radius: 20px;
                margin: 0.3rem 0;
                width: 100%;
                max-width: 280px;
            }

            /* Mobile Input Adjustments */
            .input-container {
                flex-direction: row;
                gap: 0.8rem;
            }

            .message-input {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
                border-radius: 20px;
            }

            .send-button {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            /* Mobile Typography */
            .message-content h3 {
                font-size: 1.1rem !important;
            }

            .message-content h4 {
                font-size: 1rem !important;
            }

            .message-content p {
                font-size: 0.85rem !important;
            }

            /* Mobile Cards */
            .message-content div[style*="background"] {
                padding: 12px !important;
                margin: 8px 0 !important;
                border-radius: 12px !important;
            }

            /* Mobile Price Tags */
            .message-content span[style*="background: linear-gradient"] {
                padding: 4px 8px !important;
                font-size: 0.8rem !important;
                border-radius: 15px !important;
            }
        }

        /* Tablet Responsive */
        @media (min-width: 769px) and (max-width: 1024px) {
            .header h1 {
                font-size: 1.7rem;
            }

            .chat-messages {
                padding: 1.5rem;
            }

            .message {
                max-width: 85%;
            }

            .message-content {
                padding: 1rem 1.2rem;
                font-size: 0.95rem;
            }

            .quick-actions {
                flex-wrap: wrap;
                justify-content: center;
            }

            .quick-action {
                min-width: 150px;
                text-align: center;
            }

            .interactive-options {
                flex-wrap: wrap;
                justify-content: center;
            }

            .option-btn {
                min-width: 140px;
                text-align: center;
            }

            .whatsapp-btn {
                max-width: 250px;
                margin: 0.3rem;
            }
        }

        /* Large Desktop */
        @media (min-width: 1025px) and (max-width: 1440px) {
            .chat-container {
                max-width: 1000px;
            }

            .message {
                max-width: 75%;
            }

            .interactive-options {
                max-width: 600px;
            }

            .whatsapp-btn {
                max-width: 220px;
            }
        }

        /* Ultra Wide Screens */
        @media (min-width: 1441px) {
            .chat-container {
                max-width: 1200px;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .message {
                max-width: 70%;
            }

            .message-content {
                font-size: 1rem;
                padding: 1.2rem 1.8rem;
            }
        }

        /* iPhone SE and small screens */
        @media (max-width: 375px) {
            .header {
                padding: 0.8rem 0;
            }

            .header h1 {
                font-size: 1.1rem;
                padding: 0 0.5rem;
            }

            .header p {
                font-size: 0.8rem;
                padding: 0 0.5rem;
            }

            .chat-messages {
                padding: 0.8rem;
                gap: 0.8rem;
            }

            .chat-input {
                padding: 0.8rem;
            }

            .message-content {
                padding: 0.7rem 0.8rem;
                font-size: 0.85rem;
            }

            .welcome-message {
                padding: 1rem;
                margin: 0.3rem;
            }

            .welcome-message h2 {
                font-size: 1.1rem;
            }

            .option-btn, .whatsapp-btn {
                padding: 0.7rem 0.8rem;
                font-size: 0.8rem;
            }

            .input-container {
                gap: 0.5rem;
            }

            .message-input {
                padding: 0.7rem 0.8rem;
                font-size: 0.85rem;
            }

            .send-button {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }

        /* Landscape orientation for mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .header {
                padding: 0.5rem 0;
                position: relative;
            }

            .header h1 {
                font-size: 1.2rem;
            }

            .header p {
                font-size: 0.8rem;
            }

            .chat-container {
                height: calc(100vh - 80px);
            }

            .chat-messages {
                padding: 0.8rem;
            }

            .welcome-message {
                padding: 1rem;
            }

            .quick-actions {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 0.4rem;
            }

            .quick-action {
                flex: 1;
                min-width: 120px;
                padding: 0.6rem 0.8rem;
                font-size: 0.8rem;
            }
        }

        /* Improved touch targets for mobile */
        @media (hover: none) and (pointer: coarse) {
            .option-btn, .whatsapp-btn, .quick-action {
                min-height: 44px;
                touch-action: manipulation;
            }

            .send-button {
                min-width: 44px;
                min-height: 44px;
            }

            .message-input {
                min-height: 44px;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --shadow: 0 10px 30px rgba(0,0,0,0.5);
            }
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>üíÑ DIANA PADILLA EST√âTICA & SPA</h1>
        <p>Tu Asistente Virtual Inteligente - Preg√∫ntame cualquier cosa</p>
    </header>

    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">
                <h2>¬°Bienvenida a Diana Padilla Est√©tica & Spa! ‚ú®</h2>
                <p>Soy tu asistente virtual inteligente. Puedo ayudarte con servicios, precios, horarios, ubicaci√≥n y agendar tu cita perfecta.</p>
                <div class="quick-actions">
                    <div class="quick-action" onclick="sendQuickMessage('servicios')">üé® Ver Servicios</div>
                    <div class="quick-action" onclick="sendQuickMessage('precios')">üí∞ Ver Precios</div>
                    <div class="quick-action" onclick="sendQuickMessage('horarios')">üïê Horarios</div>
                    <div class="quick-action" onclick="sendQuickMessage('ubicacion')">üìç Ubicaci√≥n</div>
                    <div class="quick-action" onclick="agendarCitaWhatsApp()">üìÖ Agendar Cita</div>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator" style="display: none;">
                <div class="message-avatar">
                    üíÑ
                </div>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>

        <div class="chat-input">
            <div class="input-container">
                <input 
                    type="text" 
                    class="message-input" 
                    id="messageInput" 
                    placeholder="Preg√∫ntame sobre cortes, manicura, precios, horarios... üí¨"
                    onkeypress="handleKeyPress(event)"
                >
                <button class="send-button" id="sendButton" onclick="sendMessage()">
                    ‚û§
                </button>
            </div>
        </div>
    </div>

    <script>
        // Informaci√≥n completa y detallada del spa - ACTUALIZADA
        const spaInfo = {
            nombre: "Diana Padilla Est√©tica y Spa",
            descripcion: "Spa de lujo especializado en belleza y bienestar, donde cada tratamiento es una experiencia √∫nica.",
            ubicacion: "Cuenca, Ecuador - Ricaurte",
            direccion: "Cuenca, Ricaurte - La Dolorosa de Princi, Cuenca 010152",
            mapsLink: "https://maps.app.goo.gl/Gy1HsE9VqtQdx2x59",
            telefono: "+593 98 799 3614",
            whatsapp: "593987993614",
            email: "dcarolina98@hotmail.com", // EMAIL ACTUALIZADO
            
            horarios: {
                dias: "Lunes a S√°bado",
                horario1: "9:00 AM - 1:00 PM",
                horario2: "2:00 PM - 7:00 PM",
                descanso: "Domingos cerrado"
            },

            servicios: {
                capilar: {
                    nombre: "üíá‚Äç‚ôÄÔ∏è Arte Capilar",
                    descripcion: "Servicios profesionales para tu cabello",
                    items: [
                        { nombre: "Cortes de dama", precio: "Desde $5", descripcion: "Cortes modernos y cl√°sicos para damas" },
                        { nombre: "Cortes de hombre", precio: "Desde $4", descripcion: "Cortes masculinos profesionales" },
                        { nombre: "Alisado con keratina", precio: "Desde $45", descripcion: "Alisado profesional realizado con productos org√°nicos que dura meses" },
                        { nombre: "Ondulaciones", precio: "Desde $15", descripcion: "Ondas perfectas y naturales" },
                        { nombre: "Tintes y rayitos", precio: "Desde $30", descripcion: "Coloraci√≥n completa, rayitos, marmoleados" },
                        { nombre: "Dise√±os de color - Balayage", precio: "Desde $50", descripcion: "T√©cnicas de coloraci√≥n premium" },
                        { nombre: "Alta frecuencia capilar", precio: "$5", descripcion: "Tratamiento capilar que fortalece el cabello, previene la ca√≠da y estimula su crecimiento" },
                        { nombre: "Repolarizaci√≥n capilar", precio: "$20", descripcion: "Reparaci√≥n profunda del cabello da√±ado" },
                        { nombre: "Extensiones cosidas", precio: "$30", descripcion: "Extensiones cosidas profesionalmente" },
                        { nombre: "Peinados", precio: "Desde $8", descripcion: "Peinados para todo evento y ocasiones especiales" },
                        { nombre: "Pulido de horquillas", precio: "$10", descripcion: "Procedimiento para cortar horquillas sin perjudicar el largo" }
                    ]
                },
                unas: {
                    nombre: "üíÖ Manicura & Pedicura",
                    descripcion: "Cuidado profesional para tus u√±as",
                    items: [
                        { nombre: "Manicura tradicional", precio: "Desde $4", descripcion: "Manicura cl√°sica con esmaltado" },
                        { nombre: "Manicura en gel", precio: "Desde $8", descripcion: "Manicura con esmalte gel de larga duraci√≥n" },
                        { nombre: "Pedicura completa", precio: "Desde $8", descripcion: "Cuidado completo para tus pies" },
                        { nombre: "Extensi√≥n de u√±as", precio: "Desde $10", descripcion: "U√±as m√°s largas y elegantes, logradas √∫nicamente con tips" },
                        { nombre: "Baby boomer y encapsulados", precio: "Desde $25", descripcion: "T√©cnicas avanzadas de nail art" },
                        { nombre: "U√±as acr√≠licas y gel", precio: "Desde $15", descripcion: "U√±as resistentes y duraderas" }
                    ]
                },
                cejas: {
                    nombre: "üëÅÔ∏è Cejas & Pesta√±as",
                    descripcion: "Realza tu mirada con nuestros tratamientos",
                    items: [
                        { nombre: "Microblading/Microshading", precio: "$70", descripcion: "Cejas perfectas con t√©cnica de micropigmentaci√≥n" },
                        { nombre: "Lash lifting efecto rimel", precio: "$20", descripcion: "Pesta√±as curvadas naturalmente" },
                        { nombre: "Cejas con henna", precio: "$10", descripcion: "Tinte natural para cejas m√°s definidas" },
                        { nombre: "Laminado de cejas", precio: "$20", descripcion: "Cejas m√°s voluminosas y ordenadas" },
                        { nombre: "Pesta√±as punto a punto", precio: "$10", descripcion: "Extensiones de pesta√±as con t√©cnica cl√°sica para un acabado natural y elegante" },
                        { nombre: "Depilaci√≥n con cera √≥ hilo", precio: "$3", descripcion: "Depilaci√≥n precisa y delicada" }
                    ]
                },
                facial: {
                    nombre: "‚ú® Tratamientos Faciales",
                    descripcion: "Cuidado especializado para tu rostro",
                    items: [
                        { nombre: "Limpieza facial profunda", precio: "$25", descripcion: "Limpieza completa y hidrataci√≥n facial" },
                        { nombre: "Exfoliaci√≥n corporal", precio: "$30", descripcion: "Renovaci√≥n completa de la piel" },
                        { nombre: "Makeup profesional", precio: "Desde $20", descripcion: "Maquillaje para eventos especiales" },
                        { nombre: "Depilaci√≥n facial con cera √≥ hilo", precio: "Desde $13", descripcion: "Depilaci√≥n suave y duradera" },
                        { nombre: "Depilaci√≥n de axilas con cera √≥ hilo", precio: "Desde $3", descripcion: "Depilaci√≥n suave y duradera" }
                    ]
                },
                relajacion: {
                    nombre: "üåø Bienestar & Relajaci√≥n",
                    descripcion: "Momentos de paz y relajaci√≥n",
                    items: [
                        { nombre: "Masajes relajantes", precio: "$20", descripcion: "Masajes terap√©uticos para tu bienestar" }
                    ]
                }
            },

            // Palabras clave para b√∫squeda inteligente
            keywords: {
                cortes: ["corte", "cortar", "cabello", "pelo", "tijera"],
                manicura: ["u√±as", "manicura", "esmalte", "nail"],
                cejas: ["cejas", "pesta√±as", "microblading", "henna", "laminado"],
                facial: ["facial", "limpieza", "cara", "rostro", "depilacion", "axila"],
                precios: ["precio", "costo", "cuanto", "valor"],
                horarios: ["hora", "horario", "abierto", "cerrado"],
                ubicacion: ["donde", "ubicacion", "direccion", "lugar"],
                masajes: ["masaje", "relajante", "terapeutico"],
                alisado: ["alisado", "keratina", "liso"],
                tinte: ["tinte", "color", "rayitos", "balayage"],
                extensiones: ["extensiones", "pesta√±as", "punto", "cosidas"]
            }
        };

        let conversationHistory = [];

        // Funci√≥n para agendar cita por WhatsApp
        function agendarCitaWhatsApp() {
            const mensaje = "¬°Hola Diana! üëã Quiero agendar una cita en tu spa. ¬øPodr√≠as ayudarme con la disponibilidad?";
            const whatsappURL = `https://wa.me/${spaInfo.whatsapp}?text=${encodeURIComponent(mensaje)}`;
            window.open(whatsappURL, '_blank');
        }

        // Funci√≥n para agendar servicio espec√≠fico
        function agendarServicioWhatsApp(servicio, precio) {
            const mensaje = `¬°Hola Diana! üëã\n\nQuiero agendar una cita para:\nüé® Servicio: ${servicio}\nüí∞ Precio: ${precio}\n\n¬øCu√°l ser√≠a la disponibilidad? ¬°Gracias!`;
            const whatsappURL = `https://wa.me/${spaInfo.whatsapp}?text=${encodeURIComponent(mensaje)}`;
            window.open(whatsappURL, '_blank');
        }

        // Men√∫s interactivos (ahora solo se usan internamente)
        function showMenuServicios() {
            const opciones = Object.keys(spaInfo.servicios).map(key => 
                `<div class="option-btn" onclick="showCategoriaServicios('${key}')">${spaInfo.servicios[key].nombre}</div>`
            ).join('');
            
            addBotMessageWithOptions("üé® **Nuestros servicios por categor√≠as:**\n\nSelecciona la categor√≠a que te interesa:", opciones);
        }

        function showMenuPrecios() {
            const opciones = Object.keys(spaInfo.servicios).map(key => 
                `<div class="option-btn" onclick="showPreciosCategoria('${key}')">${spaInfo.servicios[key].nombre}</div>`
            ).join('');
            
            addBotMessageWithOptions("üí∞ **Ver precios por categor√≠a:**\n\nElige la categor√≠a para ver precios detallados:", opciones);
        }

        function showCategoriaServicios(categoria) {
            showTyping(true);
            
            setTimeout(() => {
                const cat = spaInfo.servicios[categoria];
                
                let mensaje = `<div style="text-align: center; margin-bottom: 15px;">
                    <h3 style="color: #ff6b9d; font-size: clamp(1.1rem, 4vw, 1.3rem); margin-bottom: 8px;">${cat.nombre}</h3>
                    <p style="color: #ccc; font-style: italic; font-size: clamp(0.85rem, 3vw, 0.95rem);">${cat.descripcion}</p>
                </div>`;
                
                cat.items.forEach(item => {
                    mensaje += `<div style="background: rgba(255,107,157,0.1); padding: clamp(10px, 3vw, 15px); margin: clamp(8px, 2vw, 10px) 0; border-radius: clamp(10px, 3vw, 15px); border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 5px; gap: 10px;">
                            <strong style="color: #fff; font-size: clamp(0.95rem, 3.5vw, 1.1rem); flex: 1;">${item.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: clamp(4px, 1.5vw, 5px) clamp(8px, 2.5vw, 12px); border-radius: clamp(15px, 4vw, 20px); color: white; font-weight: bold; font-size: clamp(0.75rem, 2.5vw, 0.9rem); white-space: nowrap;">${item.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: clamp(0.8rem, 2.8vw, 0.95rem); margin: 5px 0; line-height: 1.4;">${item.descripcion}</p>
                    </div>`;
                });

                const whatsappBtn = `<div style="text-align: center; margin-top: 15px;">
                    <button class="whatsapp-btn" onclick="agendarCitaWhatsApp()" style="width: 100%; max-width: 280px;">üì± Agendar por WhatsApp</button>
                </div>`;
                
                showTyping(false);
                addBotMessage(mensaje + whatsappBtn);
            }, 1000);
        }

        function showPreciosCategoria(categoria) {
            showTyping(true);
            
            setTimeout(() => {
                const cat = spaInfo.servicios[categoria];
                
                let mensaje = `<div style="text-align: center; margin-bottom: 15px;">
                    <h3 style="color: #f8b500; font-size: clamp(1.1rem, 4vw, 1.3rem); margin-bottom: 8px;">üí∞ ${cat.nombre} - Precios</h3>
                </div>`;
                
                cat.items.forEach(item => {
                    mensaje += `<div style="display: flex; justify-content: space-between; align-items: center; padding: clamp(10px, 3vw, 12px); margin: clamp(6px, 2vw, 8px) 0; background: rgba(248,181,0,0.1); border-radius: clamp(8px, 2.5vw, 10px); border-left: 3px solid #f8b500; gap: 10px;">
                        <span style="color: #fff; font-size: clamp(0.85rem, 3vw, 1rem); flex: 1;">${item.nombre}</span>
                        <span style="color: #f8b500; font-weight: bold; font-size: clamp(0.9rem, 3.5vw, 1.1rem); white-space: nowrap;">${item.precio}</span>
                    </div>`;
                });

                const opciones = cat.items.slice(0, 3).map(item => 
                    `<div class="option-btn" onclick="agendarServicioWhatsApp('${item.nombre}', '${item.precio}')" style="margin: 5px 0;">Agendar ${item.nombre.split(' ')[0]}</div>`
                ).join('');

                showTyping(false);
                addBotMessageWithOptions(mensaje, opciones);
            }, 900);
        }

        // Inicializar chat
        document.addEventListener('DOMContentLoaded', function() {
            addBotMessage("¬°Hola! üëã Soy tu asistente virtual inteligente de Diana Padilla Est√©tica y Spa.\n\nPuedo ayudarte con:\n‚ú® Informaci√≥n detallada de servicios\nüí∞ Precios espec√≠ficos\nüïê Horarios y disponibilidad\nüìç Ubicaci√≥n\nüìÖ Agendar tu cita\n\n¬øEn qu√© puedo ayudarte hoy?");
        });

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function sendQuickMessage(message) {
            addUserMessage(message);
            
            showTyping(true);
            setTimeout(() => {
                const response = getBotResponse(message);
                showTyping(false);
                
                if (response) {
                    addBotMessage(response);
                } else {
                    addBotMessage("¬°Hola! üòä Soy tu asistente de Diana Padilla Est√©tica y Spa. ¬øEn qu√© puedo ayudarte? Puedo contarte sobre nuestros servicios, precios, horarios o ayudarte a agendar una cita.");
                }
            }, 1200);
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addUserMessage(message);
            input.value = '';
            
            showTyping(true);
            
            setTimeout(() => {
                const response = getBotResponse(message);
                showTyping(false);
                
                if (response) {
                    addBotMessage(response);
                } else {
                    addBotMessage("¬°Perfecto! üòä Te puedo ayudar con informaci√≥n sobre nuestros servicios, precios desde $3, horarios de Lunes a S√°bado, ubicaci√≥n en Ricaurte o agendar tu cita. ¬øQu√© te interesa saber?");
                }
            }, 1200);
        }

        function addUserMessage(message) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">üë§</div>
                <div class="message-content">
                    ${message}
                    <div class="message-time">${getCurrentTime()}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        function addBotMessage(message) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            
            // Procesar botones en el mensaje
            const processedMessage = message.replace(
                /<button([^>]*)>([^<]*)<\/button>/g, 
                '<button $1>$2</button>'
            );
            
            messageDiv.innerHTML = `
                <div class="message-avatar">üíÑ</div>
                <div class="message-content">
                    ${processedMessage}
                    <div class="message-time">${getCurrentTime()}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        function addBotMessageWithOptions(message, options) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">üíÑ</div>
                <div class="message-content">
                    ${message}
                    <div class="interactive-options">
                        ${options}
                    </div>
                    <div class="message-time">${getCurrentTime()}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        function showTyping(show) {
            const typingIndicator = document.getElementById('typingIndicator');
            const sendButton = document.getElementById('sendButton');
            
            if (show) {
                // Crear un nuevo indicador de carga al final
                const messagesContainer = document.getElementById('chatMessages');
                const typingDiv = document.createElement('div');
                typingDiv.className = 'message bot-message typing-message';
                typingDiv.innerHTML = `
                    <div class="message-avatar">üíÑ</div>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                messagesContainer.appendChild(typingDiv);
                scrollToBottom();
            } else {
                // Remover el indicador de carga
                const typingMessage = document.querySelector('.typing-message');
                if (typingMessage) {
                    typingMessage.remove();
                }
            }
            
            sendButton.disabled = show;
        }

        function scrollToBottom() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getCurrentTime() {
            return new Date().toLocaleTimeString('es-ES', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }

        // Funci√≥n de inteligencia mejorada para entender consultas
        function findRelevantService(query) {
            const lowerQuery = query.toLowerCase();
            const results = [];
            
            // Buscar en todas las categor√≠as y servicios
            for (const [catKey, categoria] of Object.entries(spaInfo.servicios)) {
                for (const item of categoria.items) {
                    const itemName = item.nombre.toLowerCase();
                    const itemDesc = item.descripcion.toLowerCase();
                    
                    // Verificar coincidencias exactas o parciales
                    if (itemName.includes(lowerQuery) || 
                        itemDesc.includes(lowerQuery) ||
                        lowerQuery.includes(itemName.split(' ')[0]) ||
                        checkKeywordMatch(lowerQuery, itemName)) {
                        results.push({
                            categoria: categoria.nombre,
                            item: item,
                            relevance: calculateRelevance(lowerQuery, itemName, itemDesc)
                        });
                    }
                }
            }
            
            // Ordenar por relevancia
            return results.sort((a, b) => b.relevance - a.relevance);
        }

        function checkKeywordMatch(query, itemName) {
            // Palabras clave espec√≠ficas para b√∫squeda inteligente
            const keywords = {
                'corte': ['corte', 'cortes', 'cortar'],
                'manicura': ['manicura', 'u√±as', 'esmalte'],
                'pedicura': ['pedicura', 'pies'],
                'cejas': ['cejas', 'ceja'],
                'pesta√±as': ['pesta√±as', 'pesta√±a', 'lash'],
                'facial': ['facial', 'cara', 'rostro'],
                'masaje': ['masaje', 'relajante'],
                'alisado': ['alisado', 'keratina', 'liso'],
                'tinte': ['tinte', 'color', 'rayitos', 'balayage'],
                'microblading': ['microblading', 'micropigmentacion'],
                'depilacion': ['depilacion', 'cera', 'hilo', 'axila'],
                'extensiones': ['extensiones', 'punto'],
                'henna': ['henna', 'tinte'],
                'laminado': ['laminado', 'ordenadas'],
                'exfoliacion': ['exfoliacion', 'renovacion'],
                'makeup': ['makeup', 'maquillaje'],
                'peinados': ['peinados', 'eventos']
            };
            
            for (const [key, values] of Object.entries(keywords)) {
                if (values.some(keyword => query.includes(keyword)) && 
                    itemName.toLowerCase().includes(key)) {
                    return true;
                }
            }
            return false;
        }

        function calculateRelevance(query, itemName, itemDesc) {
            let score = 0;
            const queryWords = query.split(' ');
            const nameWords = itemName.toLowerCase().split(' ');
            
            // Coincidencia exacta en nombre
            if (itemName.toLowerCase() === query) score += 100;
            
            // Coincidencias parciales
            queryWords.forEach(qWord => {
                if (qWord.length > 2) {
                    if (itemName.toLowerCase().includes(qWord)) score += 10;
                    if (itemDesc.toLowerCase().includes(qWord)) score += 5;
                }
            });
            
            return score;
        }

        function getBotResponse(userMessage) {
            conversationHistory.push({ role: "user", content: userMessage });
            
            const message = userMessage.toLowerCase();
            
            // Respuestas inteligentes para consultas espec√≠ficas
            
            // Servicios completos (respuesta al bot√≥n "Ver Servicios")
            if (message.includes('servicios') && !message.includes('precio') && !message.includes('costo')) {
                const opciones = Object.keys(spaInfo.servicios).map(key => 
                    `<div class="option-btn" onclick="showCategoriaServicios('${key}')">${spaInfo.servicios[key].nombre}</div>`
                ).join('');
                
                return `üé® Nuestros servicios por categor√≠as:\n\nSelecciona la categor√≠a que te interesa:\n\n<div class="interactive-options">${opciones}</div>`;
            }

            // Precios completos (respuesta al bot√≥n "Ver Precios") 
            if ((message.includes('precios') || (message.includes('precio') && message.includes('categoria'))) && !message.includes('corte') && !message.includes('manicura')) {
                const opciones = Object.keys(spaInfo.servicios).map(key => 
                    `<div class="option-btn" onclick="showPreciosCategoria('${key}')">${spaInfo.servicios[key].nombre}</div>`
                ).join('');
                
                return `üí∞ Ver precios por categor√≠a:\n\nElige la categor√≠a para ver precios detallados:\n\n<div class="interactive-options">${opciones}</div>`;
            }
            // B√∫squeda de servicios espec√≠ficos
            if (message.includes('corte') || message.includes('cortar')) {
                const cortesData = spaInfo.servicios.capilar.items.filter(item => 
                    item.nombre.toLowerCase().includes('corte')
                );
                
                let respuesta = `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">‚úÇÔ∏è Nuestros servicios de cortes</h3>
                </div>`;
                
                cortesData.forEach(corte => {
                    respuesta += `<div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #fff; font-size: 1.1rem;">${corte.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 5px 12px; border-radius: 20px; color: white; font-weight: bold;">${corte.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: 0.95rem;">${corte.descripcion}</p>
                    </div>`;
                });
                
                const opciones = cortesData.map(corte => 
                    `<div class="option-btn" onclick="agendarServicioWhatsApp('${corte.nombre}', '${corte.precio}')">Agendar ${corte.nombre}</div>`
                ).join('');
                
                return respuesta + `<div class="interactive-options">${opciones}</div>`;
            }

            // Manicura y u√±as
            if (message.includes('manicura') || message.includes('u√±as') || message.includes('nail')) {
                const manicuraData = spaInfo.servicios.unas;
                
                let respuesta = `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">${manicuraData.nombre}</h3>
                    <p style="color: #ccc; font-style: italic;">${manicuraData.descripcion}</p>
                </div>`;
                
                manicuraData.items.forEach(item => {
                    respuesta += `<div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #fff; font-size: 1.1rem;">${item.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 5px 12px; border-radius: 20px; color: white; font-weight: bold;">${item.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: 0.95rem;">${item.descripcion}</p>
                    </div>`;
                });
                
                const opciones = manicuraData.items.slice(0, 3).map(item => 
                    `<div class="option-btn" onclick="agendarServicioWhatsApp('${item.nombre}', '${item.precio}')">Agendar ${item.nombre.split(' ')[0]}</div>`
                ).join('');
                
                return respuesta + `<div class="interactive-options">${opciones}</div>`;
            }

            // Depilaci√≥n espec√≠fica
            if (message.includes('depilacion') || message.includes('depilar') || message.includes('cera') || message.includes('hilo')) {
                let respuesta = `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">ü™í Servicios de Depilaci√≥n</h3>
                </div>`;
                
                const depilacionItems = [
                    ...spaInfo.servicios.cejas.items.filter(item => item.nombre.toLowerCase().includes('depilacion')),
                    ...spaInfo.servicios.facial.items.filter(item => item.nombre.toLowerCase().includes('depilacion'))
                ];
                
                depilacionItems.forEach(item => {
                    respuesta += `<div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #fff; font-size: 1.1rem;">${item.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 5px 12px; border-radius: 20px; color: white; font-weight: bold;">${item.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: 0.95rem;">${item.descripcion}</p>
                    </div>`;
                });
                
                respuesta += `<div style="text-align: center; margin-top: 20px;">
                    <button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Agendar por WhatsApp</button>
                </div>`;
                
                return respuesta;
            }

            // Alisado y keratina
            if (message.includes('alisado') || message.includes('keratina') || message.includes('liso')) {
                const alisadoItem = spaInfo.servicios.capilar.items.find(item => 
                    item.nombre.toLowerCase().includes('alisado')
                );
                
                return `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">‚ú® Alisado con Keratina</h3>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 20px; margin: 15px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong style="color: #fff; font-size: 1.2rem;">${alisadoItem.nombre}</strong>
                        <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 8px 15px; border-radius: 20px; color: white; font-weight: bold; font-size: 1.1rem;">${alisadoItem.precio}</span>
                    </div>
                    <p style="color: #bbb; font-size: 1rem; line-height: 1.5;">${alisadoItem.descripcion}</p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="whatsapp-btn" onclick="agendarServicioWhatsApp('${alisadoItem.nombre}', '${alisadoItem.precio}')">üì± Agendar Alisado</button>
                </div>`;
            }

            // Masajes
            if (message.includes('masaje') || message.includes('relajante') || message.includes('terapeutico')) {
                const masajeItem = spaInfo.servicios.relajacion.items[0];
                
                return `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">üåø Masajes Relajantes</h3>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 20px; margin: 15px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong style="color: #fff; font-size: 1.2rem;">${masajeItem.nombre}</strong>
                        <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 8px 15px; border-radius: 20px; color: white; font-weight: bold; font-size: 1.1rem;">${masajeItem.precio}</span>
                    </div>
                    <p style="color: #bbb; font-size: 1rem; line-height: 1.5;">${masajeItem.descripcion}</p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="whatsapp-btn" onclick="agendarServicioWhatsApp('${masajeItem.nombre}', '${masajeItem.precio}')">üì± Agendar Masaje</button>
                </div>`;
            }

            // Cejas y pesta√±as
            if (message.includes('cejas') || message.includes('pesta√±as') || message.includes('microblading') || message.includes('lash') || message.includes('henna')) {
                const cejasData = spaInfo.servicios.cejas;
                
                let respuesta = `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">${cejasData.nombre}</h3>
                    <p style="color: #ccc; font-style: italic;">${cejasData.descripcion}</p>
                </div>`;
                
                cejasData.items.forEach(item => {
                    respuesta += `<div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #fff; font-size: 1.1rem;">${item.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 5px 12px; border-radius: 20px; color: white; font-weight: bold;">${item.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: 0.95rem;">${item.descripcion}</p>
                    </div>`;
                });
                
                const opciones = cejasData.items.slice(0, 3).map(item => 
                    `<div class="option-btn" onclick="agendarServicioWhatsApp('${item.nombre}', '${item.precio}')">Agendar ${item.nombre.split(' ')[0]}</div>`
                ).join('');
                
                return respuesta + `<div class="interactive-options">${opciones}</div>`;
            }

            // B√∫squeda general de servicios
            const serviciosEncontrados = findRelevantService(message);
            if (serviciosEncontrados.length > 0) {
                let respuesta = `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">üéØ Servicios encontrados para ti</h3>
                </div>`;
                
                serviciosEncontrados.slice(0, 4).forEach(resultado => {
                    const item = resultado.item;
                    respuesta += `<div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #fff; font-size: 1.1rem;">${item.nombre}</strong>
                            <span style="background: linear-gradient(135deg, #ff6b9d, #c44569); padding: 5px 12px; border-radius: 20px; color: white; font-weight: bold;">${item.precio}</span>
                        </div>
                        <p style="color: #bbb; font-size: 0.95rem;">${item.descripcion}</p>
                        <p style="color: #f8b500; font-size: 0.85rem; margin-top: 5px;">üìÇ ${resultado.categoria}</p>
                    </div>`;
                });
                
                const opciones = serviciosEncontrados.slice(0, 3).map(resultado => {
                    const item = resultado.item;
                    return `<div class="option-btn" onclick="agendarServicioWhatsApp('${item.nombre}', '${item.precio}')">Agendar ${item.nombre.split(' ')[0]}</div>`;
                }).join('');
                
                return respuesta + `<div class="interactive-options">${opciones}</div>`;
            }

            // Precios generales
            if (message.includes('precio') || message.includes('costo') || message.includes('cuanto')) {
                return `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #f8b500; font-size: 1.3rem; margin-bottom: 10px;">üí∞ Nuestros precios principales</h3>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #ff6b9d; margin-bottom: 10px;">‚úÇÔ∏è Cortes</h4>
                    <p style="color: #fff;">‚Ä¢ Dama: <span style="color: #f8b500; font-weight: bold;">Desde $5</span></p>
                    <p style="color: #fff;">‚Ä¢ Hombre: <span style="color: #f8b500; font-weight: bold;">Desde $4</span></p>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #ff6b9d; margin-bottom: 10px;">üíÖ Manicura</h4>
                    <p style="color: #fff;">‚Ä¢ Tradicional: <span style="color: #f8b500; font-weight: bold;">Desde $4</span></p>
                    <p style="color: #fff;">‚Ä¢ En gel: <span style="color: #f8b500; font-weight: bold;">Desde $8</span></p>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #ff6b9d; margin-bottom: 10px;">üëÅÔ∏è Cejas & Pesta√±as</h4>
                    <p style="color: #fff;">‚Ä¢ Microblading: <span style="color: #f8b500; font-weight: bold;">$70</span></p>
                    <p style="color: #fff;">‚Ä¢ Lash lifting: <span style="color: #f8b500; font-weight: bold;">$20</span></p>
                    <p style="color: #fff;">‚Ä¢ Cejas con henna: <span style="color: #f8b500; font-weight: bold;">$10</span></p>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 15px; margin: 10px 0; border-radius: 15px; border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #ff6b9d; margin-bottom: 10px;">‚ú® Faciales & Depilaci√≥n</h4>
                    <p style="color: #fff;">‚Ä¢ Limpieza facial: <span style="color: #f8b500; font-weight: bold;">$25</span></p>
                    <p style="color: #fff;">‚Ä¢ Depilaci√≥n facial: <span style="color: #f8b500; font-weight: bold;">Desde $13</span></p>
                    <p style="color: #fff;">‚Ä¢ Masajes: <span style="color: #f8b500; font-weight: bold;">$20</span></p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Agendar por WhatsApp</button>
                </div>`;
            }

            // Horarios
            if (message.includes('hora') || message.includes('horario') || message.includes('abierto')) {
                return `<div style="text-align: center; margin-bottom: 20px;">
                    <h3 style="color: #ff6b9d; font-size: 1.3rem; margin-bottom: 10px;">üïê Nuestros horarios de atenci√≥n</h3>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: 20px; margin: 15px 0; border-radius: 15px; text-align: center; border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #f8b500; margin-bottom: 15px;">üìÖ ${spaInfo.horarios.dias}</h4>
                    <p style="color: #fff; font-size: 1.1rem; margin: 8px 0;">üåÖ Ma√±ana: <span style="color: #f8b500; font-weight: bold;">${spaInfo.horarios.horario1}</span></p>
                    <p style="color: #fff; font-size: 1.1rem; margin: 8px 0;">üåÜ Tarde: <span style="color: #f8b500; font-weight: bold;">${spaInfo.horarios.horario2}</span></p>
                    <p style="color: #ccc; font-style: italic; margin-top: 15px;">üè† ${spaInfo.horarios.descanso}</p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Agendar mi cita</button>
                </div>`;
            }

            // Ubicaci√≥n - ACTUALIZADA
            if (message.includes('ubicacion') || message.includes('donde') || message.includes('direccion')) {
                return `<div style="text-align: center; margin-bottom: 15px;">
                    <h3 style="color: #ff6b9d; font-size: clamp(1.1rem, 4vw, 1.3rem); margin-bottom: 8px;">üìç Nuestra ubicaci√≥n</h3>
                </div>
                
                <div style="background: rgba(255,107,157,0.1); padding: clamp(15px, 4vw, 20px); margin: clamp(10px, 3vw, 15px) 0; border-radius: clamp(10px, 3vw, 15px); border-left: 3px solid #ff6b9d;">
                    <h4 style="color: #f8b500; margin-bottom: 8px; font-size: clamp(1rem, 3.5vw, 1.2rem);">üè¢ ${spaInfo.ubicacion}</h4>
                    <p style="color: #fff; margin: 6px 0; font-size: clamp(0.85rem, 3vw, 1rem); line-height: 1.4;">${spaInfo.direccion}</p>
                </div>
                
                <div style="background: rgba(248,181,0,0.1); padding: clamp(12px, 3.5vw, 15px); margin: clamp(10px, 3vw, 15px) 0; border-radius: clamp(10px, 3vw, 15px); border-left: 3px solid #f8b500;">
                    <h4 style="color: #f8b500; margin-bottom: 8px; font-size: clamp(1rem, 3.5vw, 1.2rem);">üìû Contacto directo</h4>
                    <p style="color: #fff; margin: 4px 0; font-size: clamp(0.8rem, 2.8vw, 0.95rem);">‚Ä¢ Tel√©fono: <span style="color: #f8b500;">${spaInfo.telefono}</span></p>
                    <p style="color: #fff; margin: 4px 0; font-size: clamp(0.8rem, 2.8vw, 0.95rem);">‚Ä¢ WhatsApp: <span style="color: #f8b500;">${spaInfo.telefono}</span></p>
                    <p style="color: #fff; margin: 4px 0; font-size: clamp(0.8rem, 2.8vw, 0.95rem);">‚Ä¢ Email: <span style="color: #f8b500; word-break: break-word;">${spaInfo.email}</span></p>
                </div>
                
                <div style="text-align: center; margin-top: 15px; display: flex; flex-direction: column; gap: 8px; align-items: center;">
                    <button class="whatsapp-btn" onclick="window.open('${spaInfo.mapsLink}', '_blank')" style="background: linear-gradient(135deg, #4285F4, #34A853); width: 100%; max-width: 280px;">üó∫Ô∏è Ver en Google Maps</button>
                    <button class="whatsapp-btn" onclick="agendarCitaWhatsApp()" style="width: 100%; max-width: 280px;">üì± Escribir por WhatsApp</button>
                </div>`;
            }

            // Agendar citas
            if (message.includes('cita') || message.includes('reserva') || message.includes('agendar')) {
                const opciones = `
                    <div class="option-btn" onclick="showMenuServicios()">Ver todos los servicios</div>
                    <div class="option-btn" onclick="agendarCitaWhatsApp()">Agendar ahora</div>
                `;
                
                return `üìÖ ¬°Perfecto! Te ayudo a agendar tu cita:\n\nüéØ Opciones disponibles:\n‚Ä¢ Puedes explorar nuestros servicios primero\n‚Ä¢ O agendar directamente por WhatsApp\n\nüïê Disponibilidad:\n${spaInfo.horarios.dias} de ${spaInfo.horarios.horario1} y ${spaInfo.horarios.horario2}\n\n<div class="interactive-options">${opciones}</div>`;
            }

            // RESPUESTA MEJORADA - fallback inteligente
            return getLocalFallbackResponse(userMessage);
        }

        function getLocalFallbackResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Respuestas m√°s inteligentes seg√∫n el contexto
            if (message.includes('hola') || message.includes('buenos') || message.includes('buenas')) {
                return `¬°Hola! üëã Bienvenida a Diana Padilla Est√©tica y Spa. \n\nSoy tu asistente virtual y estoy aqu√≠ para ayudarte con:\n‚ú® Servicios (cortes desde $4)\nüí∞ Precios actualizados\nüïê Horarios\nüìç Ubicaci√≥n en Ricaurte\nüìÖ Agendar citas\n\n¬øEn qu√© puedo ayudarte hoy? üòä\n\n<button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Contactar por WhatsApp</button>`;
            }
            
            if (message.includes('gracias') || message.includes('perfecto') || message.includes('excelente')) {
                return `¬°De nada! üòä Me alegra poder ayudarte. \n\nSi necesitas agendar una cita o tienes m√°s preguntas, no dudes en escribirme. Estoy aqu√≠ para ti las 24 horas.\n\n<button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Agendar por WhatsApp</button>`;
            }
            
            if (message.includes('adios') || message.includes('hasta luego') || message.includes('chao')) {
                return `¬°Hasta luego! üëã Fue un placer ayudarte.\n\nRecuerda que puedes contactarnos cuando gustes:\nüìû ${spaInfo.telefono}\nüìç ${spaInfo.ubicacion}\n\n¬°Esperamos verte pronto en Diana Padilla Est√©tica y Spa! ‚ú®`;
            }

            // Respuestas espec√≠ficas mejoradas
            if (message.includes('nombre') || message.includes('llamas') || message.includes('como te llamas')) {
                return `Soy tu asistente virtual de Diana Padilla Est√©tica y Spa üíÑ\n\nPuedo ayudarte con toda la informaci√≥n que necesites:\n‚Ä¢ Servicios de belleza completos\n‚Ä¢ Precios desde $3\n‚Ä¢ Horarios: ${spaInfo.horarios.dias}\n‚Ä¢ Ubicaci√≥n en ${spaInfo.ubicacion}\n‚Ä¢ Agendar citas\n\n¬øQu√© te gustar√≠a saber? üòä`;
            }

            if (message.includes('telefono') || message.includes('numero') || message.includes('contacto')) {
                return `üìû Aqu√≠ tienes nuestros datos de contacto:\n\n‚Ä¢ Tel√©fono: ${spaInfo.telefono}\n‚Ä¢ WhatsApp: ${spaInfo.telefono}\n‚Ä¢ Email: ${spaInfo.email}\n‚Ä¢ Ubicaci√≥n: ${spaInfo.ubicacion}\n\n<button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Escribir por WhatsApp</button>`;
            }

            if (message.includes('ayuda') || message.includes('que puedes hacer')) {
                return `¬°Claro! Te puedo ayudar con: üòä\n\nüé® **Servicios completos:**\n‚Ä¢ Arte capilar (cortes, alisado, tintes)\n‚Ä¢ Manicura y pedicura\n‚Ä¢ Cejas y pesta√±as\n‚Ä¢ Tratamientos faciales\n‚Ä¢ Masajes relajantes\n\nüí∞ **Informaci√≥n de precios**\nüïê **Horarios de atenci√≥n**\nüìç **Ubicaci√≥n y contacto**\nüìÖ **Agendar tu cita**\n\n¬øQu√© te interesa conocer?`;
            }
            
            // Respuesta general mejorada para consultas no reconocidas
            return `¬°Hola! üòä Soy tu asistente de Diana Padilla Est√©tica y Spa en Ricaurte, Cuenca.\n\nPuedo ayudarte con:\n‚ú® Servicios de belleza completos\nüí∞ Precios desde $3\nüïê Horarios (${spaInfo.horarios.dias})\nüìç Ubicaci√≥n y contacto\nüìÖ Agendar tu cita perfecta\n\nEscribe lo que necesitas o usa los botones:\n\n<button class="whatsapp-btn" onclick="agendarCitaWhatsApp()">üì± Contactar por WhatsApp</button>\n\n¬øEn qu√© te puedo ayudar espec√≠ficamente? üíÑ`;
        }
    </script>
</body>
</html>
